<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Automated Governance Report</title>
    <style>
        :root { --pass: #2ecc71; --fail: #e74c3c; --bg: #1e1e1e; --card: #2d2d2d; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: #fff; padding: 2rem; }
        .header { border-bottom: 1px solid #444; padding-bottom: 1rem; margin-bottom: 2rem; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem; }
        .card { background: var(--card); padding: 1.5rem; border-radius: 8px; border-top: 4px solid #555; }
        .PASS { border-top-color: var(--pass); } .FAIL { border-top-color: var(--fail); }
        .tag { font-size: 0.8rem; padding: 2px 8px; border-radius: 4px; background: #444; margin-right: 5px; }
        pre { background: #111; padding: 1rem; font-size: 0.85rem; overflow-x: auto; color: #bbb; }
    </style>
</head>
<body>
    <div class="header">
        <h1>Governance Scan: <span id="time"></span></h1>
        <p>
            Framework: <strong>SOC 2 Type 1</strong> | 
            Status: <span id="summary"></span> | 
            Files Scanned: <span id="files_scanned"></span> | 
            Path: <span id="path"></span>
        </p>
    </div>
    <div class="grid" id="results"></div>

    <div class="card FAIL" id="gpg-guide" style="display:none;">
        <h3>Manual Remediation: SOC2-CC1.5</h3>
        <p>Your latest commit is unsigned. To fix this:</p>
        <pre>
        1. gpg --full-generate-key
        2. git config --global commit.gpgsign true
        3. git commit --amend --no-edit -S
        </pre>
    </div>

    <script>
        const data = {{AUDIT_DATA}};
        document.getElementById('time').innerText = data.metadata.scan_time;
        document.getElementById('summary').innerText = `${data.stats.pass} Passed / ${data.stats.fail} Failed`;
        document.getElementById('files_scanned').innerText = data.metadata.files_scanned;
        document.getElementById('path').innerText = data.metadata.target_path;

        const container = document.getElementById('results');
        data.findings.forEach(f => {
            const card = document.createElement('div');
            card.className = `card ${f.status}`;
            card.innerHTML = `
                <h3><span class="tag">${f.type}</span> ${f.id}</h3>
                <p>Status: <strong>${f.status}</strong></p>
                <pre>${JSON.stringify(f.evidence, null, 2)}</pre>
            `;
            container.appendChild(card);
        });
    </script>

    <script>
        // Show guide only if GPG check failed
        if (data.findings.find(f => f.id === 'SOC2-CC1.5' && f.status === 'FAIL')) {
            document.getElementById('gpg-guide').style.display = 'block';
        }
    </script>

</body>
</html>
